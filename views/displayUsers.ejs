<!DOCTYPE html>
 <html lang="en">
 <head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <link rel="icon" type="image/png" href="/images/favicon.png">
   <title>Users</title>
 
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
 
   <style>
     body {
       background-color: #f5f5f5;
       font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
     }
 
     .navbar-brand {
       font-weight: 600;
     }
 
     .role-badge {
       display: inline-flex;
       align-items: center;
       padding: 0.25rem 0.7rem;
       border-radius: 999px;
       font-size: 0.8rem;
       font-weight: 600;
     }
 
     .role-manager {
       background-color: #fff3cd;
       color: #856404;
     }
 
     .role-user {
       background-color: #e2e3e5;
       color: #383d41;
     }
 
     .card {
       border-radius: 14px;
       box-shadow: 0 8px 25px rgba(0, 0, 0, 0.06);
       border: none;
     }
 
     .btn-sm {
       padding-inline: 0.6rem;
     }
 
     .btn-primary {
       background-color: #FF4E00;
       border-color: #FF4E00;
       transition: all .2s ease;
     }
 
     .btn-primary:hover {
       background-color: #ff7a33;
       border-color: #ff7a33;
       transform: translateY(-2px);
       box-shadow: 0 4px 10px rgba(255, 78, 0, 0.25);
     }
   </style>
 </head>
 
 <body>
 
   <!-- NAVBAR -->
   <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom shadow-sm">
     <div class="container">
       <a class="navbar-brand" href="/login">CampusLytics</a>
 
       <div class="ms-auto d-flex gap-2">
         <% if (loggedIn) { %>
           <form action="/logout" method="get" class="m-0">
             <button type="submit" class="btn btn-outline-secondary btn-sm">
               Logout
             </button>
           </form>
         <% } else { %>
           <form action="/login" method="get" class="m-0">
             <button type="submit" class="btn btn-primary btn-sm">
               Login
             </button>
           </form>
         <% } %>
 
         <form action="/login" method="get" class="m-0">
           <button type="submit" class="btn btn-outline-primary btn-sm">
             Home
           </button>
         </form>
       </div>
     </div>
   </nav>
 
   <!-- MAIN CONTENT -->
   <div class="container my-5">
 
     <% if (typeof error_message !== 'undefined' && error_message) { %>
       <div class="alert alert-danger mt-2" role="alert">
         <%= error_message %>
       </div>
     <% } %>
 
     <div class="card mt-4">
       <div class="card-body">
 
         <!-- Header + Role -->
         <div class="d-flex justify-content-between align-items-center mb-3">
           <div>
             <h1 class="h4 mb-1">Users</h1>
             <small class="text-muted">
               View all users currently associated with your account.
             </small>
           </div>
 
           <div>
             <% if (level === 'M') { %>
               <span class="role-badge role-manager">Manager</span>
             <% } else if (level === 'U') { %>
               <span class="role-badge role-user">User</span>
             <% } %>
           </div>
         </div>
 
         <% if (users.length === 0) { %>
           <div class="alert alert-warning" role="alert">
             No users found in the database.
           </div>
         <% } else { %>
 
           <div class="table-responsive">
             <table class="table table-striped table-hover align-middle">
               <thead class="table-light">
                 <tr>
                   <th>Username</th>
                   <th>Email</th>
                   <th>Password</th>
                   <th>User Type</th>
                   <% if (level === 'M') { %>
                     <th>Edit</th>
                     <th>Delete</th>
                   <% } %>
                 </tr>
               </thead>
               <tbody>
                 <% for (let iCount = 0; iCount < users.length; iCount++) { %>
                   <tr>
                     <td><%= users[iCount].username %></td>
                     <td><%= users[iCount].email %></td>
                     <td><%= users[iCount].password %></td>
                     <% if (users[iCount].level === 'M'){ %>
                        <td>Account Manager</td>
                    <% } else { %>
                        <td>Viewer</td>
                    <% } %>
                     <% if (level === 'M') { %>
                       <td>
                         <form action="/editUser/<%= users[iCount].username %>" method="get" class="m-0">
                           <button type="submit" class="btn btn-sm btn-outline-primary">
                             Edit
                           </button>
                         </form>
                       </td>
                       <% if (users[iCount].level === 'U') { %>
                       <td>
                         <form action="/deleteUser/<%= users[iCount].username %>" method="post" class="m-0"
                               onsubmit="return confirm('Are you sure you want to delete this user?');">
                           <button type="submit" class="btn btn-sm btn-outline-danger">
                             Delete
                           </button>
                         </form>
                       </td>
                       <% } else { %>
                        <td></td>
                        <% } %>
                     <% } %>
                   </tr>
                 <% } %>
               </tbody>
             </table>
           </div>
 
         <% } %>
 
         <% if (level === 'M') { %>
           <div class="mt-3">
             <form action="/addUser" method="get" class="m-0">
               <button type="submit" class="btn btn-primary">
                 Add User
               </button>
             </form>
           </div>
         <% } %>
 
       </div>
     </div>
 
   </div>
 </body>
 </html>
 